/*!
 * Filterable jQuery plugin v1.1.0
 * https://github.com/rogierborst/jQuery-Filterable
 *
 * Copyright 2015 Rogier Borst
 * Released under the MIT license
 */
!function(a){"use strict";function b(b,c){var e=this;e.config=a.extend({},d,c),e.$table=b,e.activeFilters=[],e.activeSearchTerm="",e.numberOfColumns=0,e.init()}var c="filterable",d={tickCheckboxesAtStart:!1,clearSearchBoxAtStart:!1,caseSensitiveFilter:!1,caseSensitiveSearch:!1,oddRowClass:"",evenRowClass:"",emptyTableMessage:"",emptyTableMessageClass:"empty-table-message",arrayData:{}};b.prototype={init:function(){var b=this;b.$controls=a(b.$table.data("filter-controls")),b.$searchBox=a(b.$table.data("search-controls")),b.numberOfColumns=a("thead th",b.$table).length,b.config.tickCheckboxesAtStart?a("input:checkbox",b.$controls).prop("checked",!0):a("input:checkbox:not(:checked)",b.$controls).each(function(){b._onCheckboxChange(this)}),b.config.clearSearchBoxAtStart?b.$searchBox.val(""):b.$searchBox.val()&&b.updateSearchTerm(b.$searchBox.val()),b.config.emptyTableMessage&&b._setupEmptyTableMessage(),b.$controls.on("change","input[type=checkbox]",function(){b._onCheckboxChange(this)}),b.$searchBox.on("keyup",function(){b.updateSearchTerm(a(this).val())})},setRowClasses:function(){a("tbody tr",this.$table).removeClass(this.config.oddRowClass+" "+this.config.evenRowClass),this.config.oddRowClass&&a("tbody tr:visible:even",this.$table).addClass(this.config.oddRowClass),this.config.evenRowClass&&a("tbody tr:visible:odd",this.$table).addClass(this.config.evenRowClass)},checkRows:function(){var b=this,c=b.config.emptyTableMessageClass;a("tbody tr",b.$table).each(function(){a(this).hasClass(c)||(b._rowIsFiltered(this)||!b._rowContainsSearchItem(this)?a(this).hide():a(this).show())}),b.config.emptyTableMessage&&b.checkIfTableIsEmpty(),(b.config.oddRowClass||b.config.evenRowClass)&&b.setRowClasses()},_rowIsFiltered:function(a){for(var b in this.activeFilters)if(this._checkFilter(this.activeFilters[b],a)===!0)return!0;return!1},_checkFilter:function(b,c){var d="cell"===b.scope?a(c).find("td").eq(b.name).text():a(c).attr("data-"+b.name);return d=a.trim(this.config.caseSensitiveFilter?d:d.toUpperCase()),"simple"===b.type?this._checkSimpleFilter(b,d):"array"===b.type?this._checkArrayFilter(b,d):void 0},_checkSimpleFilter:function(b,c){return a.inArray(c,b.terms)>-1},_checkArrayFilter:function(b,c){var d=c.split(b.separator);if(!b.exclusive&&d.length>b.terms.length)return!1;for(var e in d)if(a.inArray(d[e],b.terms)>-1){if(b.exclusive)return!0}else if(!b.exclusive)return!1;return b.exclusive?!1:!0},_rowContainsSearchItem:function(b){return""===this.activeSearchTerm?!0:this.config.caseSensitiveSearch?a("td:contains("+this.activeSearchTerm+")",b).length>0:a("td:containsNC("+this.activeSearchTerm+")",b).length>0},_onCheckboxChange:function(b){var c,d=a(b),e="undefined"!=typeof d.data("filter-content")?d.data("filter-content"):d.val(),f=a(b).is(":checked")?"off":"on";c=d.data("filterColumn")||d.data("filterRowData"),e=this.config.caseSensitiveFilter?e:e.toUpperCase(),this.updateFilters(c,e,f),this.checkRows()},updateFilters:function(a,b,c){for(var d={},e=-1,f=0;f<this.activeFilters.length;f++)if(this.activeFilters[f].name===a){d=this.activeFilters[f],e=f;break}0>e&&(d.type="undefined"!=typeof this.config.arrayData[a]?"array":"simple",d.scope="number"==typeof a?"cell":"row",d.name=a,d.terms=[],"array"===d.type&&(d.exclusive=this.config.arrayData[a].exclusive||!1,d.separator=this.config.arrayData[a].separator||", ")),d=this._updateFilterTerms(d,b,c),d.terms.length<1?this.activeFilters.splice(e,1):e>-1?this.activeFilters[e]=d:this.activeFilters.push(d)},_updateFilterTerms:function(a,b,c){if("on"===c)a.terms.push(b);else for(var d=a.terms.length-1;d>=0;d--)a.terms[d]===b&&a.terms.splice(d,1);return a},updateSearchTerm:function(a){this.activeSearchTerm=this.config.caseSensitiveSearch?a:a.toUpperCase(),this.checkRows()},_setupEmptyTableMessage:function(){var b=a("<tr></tr>").addClass(this.config.emptyTableMessageClass);a("<td></td>").attr("colspan",this.numberOfColumns).html(this.config.emptyTableMessage).appendTo(b),b.hide().prependTo("tbody",this.$table)},checkIfTableIsEmpty:function(){var b=this.config.emptyTableMessageClass,c=a("tbody tr:visible",self.$table);return c.length?c.length===a("."+b).length?!0:void a("."+b).hide():(a("."+b).show(),!0)}},a.fn.filterable=function(d){return"undefined"==typeof d||"object"==typeof d?this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(a(this),d))}):void 0},a.extend(a.expr[":"],{containsNC:function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf((c[3]||"").toLowerCase())>=0}})}(jQuery,window,document);