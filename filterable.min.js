/*!
 * Filterable jQuery plugin v1.0.0
 * https://github.com/rogierborst/jQuery-Filterable
 *
 * Copyright 2015 Rogier Borst
 * Released under the MIT license
 */
!function(a){"use strict";function b(b,c){var e=this;e.config=a.extend({},d,c),e.$table=b,e.activeFilter={},e.activeFilterColumns=[],e.activeSearchTerm="",e.numberOfColumns=0,e.init()}var c="filterable",d={tickCheckboxesAtStart:!1,clearSearchBoxAtStart:!1,caseSensitiveFilter:!1,caseSensitiveSearch:!1,oddRowClass:"",evenRowClass:"",emptyTableMessage:"",emptyTableMessageClass:"empty-table-message",arrayColumns:{}};b.prototype={init:function(){var b=this;b.$controls=a(b.$table.data("filter-controls")),b.$searchBox=a(b.$table.data("search-controls")),b.numberOfColumns=a("thead th",b.$table).length,b.config.tickCheckboxesAtStart?a("input:checkbox",b.$controls).prop("checked",!0):a("input:checkbox:not(:checked)",b.$controls).each(function(){b.updateFilter(this)}),b.config.clearSearchBoxAtStart?b.$searchBox.val(""):b.$searchBox.val()&&b.updateSearchTerm(b.$searchBox.val()),b.config.emptyTableMessage&&b.setupEmptyTableMessage(),b.$controls.on("change","input[type=checkbox]",function(){b.updateFilter(this)}),b.$searchBox.on("keyup",function(){b.updateSearchTerm(a(this).val())})},setRowClasses:function(){a("tbody tr",this.$table).removeClass(this.config.oddRowClass+" "+this.config.evenRowClass),this.config.oddRowClass&&a("tbody tr:visible:even",this.$table).addClass(this.config.oddRowClass),this.config.evenRowClass&&a("tbody tr:visible:odd",this.$table).addClass(this.config.evenRowClass)},checkRows:function(){var b=this,c=b.config.emptyTableMessageClass;a("tbody tr",b.$table).each(function(){a(this).hasClass(c)||(b.rowIsFiltered(this)||!b.rowContainsSearchItem(this)?a(this).hide():a(this).show())}),b.config.emptyTableMessage&&b.checkIfTableIsEmpty(),(b.config.oddRowClass||b.config.evenRowClass)&&b.setRowClasses()},rowIsFiltered:function(b){var c=!1;for(var d in this.activeFilterColumns){var e=this.activeFilterColumns[d],f=a(b).find("td").eq(e).text().trim();if(this.config.arrayColumns.hasOwnProperty(e)){if(this.checkArrayFilter(f,e)){c=!0;break}}else if(this.checkSimpleFilter(f,e)){c=!0;break}}return c},checkSimpleFilter:function(b,c){return b=this.config.caseSensitiveFilter?b:b.toUpperCase(),a.inArray(b,this.activeFilter[c])>-1},checkArrayFilter:function(b,c){var d=this.config.arrayColumns[c].separator,e=this.config.arrayColumns[c].exclusive,f=b.split(d);if(this.config.caseSensitiveFilter||(f=a.map(f,function(a){return a.toUpperCase()})),!e&&f.length>this.activeFilter[c].length)return!1;if(e){var g=!1;for(var h in f)a.inArray(f[h],this.activeFilter[c])>-1&&(g=!0);return g}for(var i in f)if(-1===a.inArray(f[i],this.activeFilter[c]))return!1;return!0},rowContainsSearchItem:function(b){return""===this.activeSearchTerm?!0:this.config.caseSensitiveSearch?a("td:contains("+this.activeSearchTerm+")",b).length>0:a("td:containsNC("+this.activeSearchTerm+")",b).length>0},updateFilter:function(b){var c=a(b),d=c.data("filter-column"),e="undefined"!=typeof c.attr("data-filter-content")?c.data("filter-content"):c.val();e=this.config.caseSensitiveFilter?e:e.toUpperCase(),this.activeFilter[d]=this.activeFilter[d]||[];var f=a.inArray(e,this.activeFilter[d]);f>-1?this.activeFilter[d].splice(f,1):this.activeFilter[d].push(e),this.activeFilterColumns=a.map(this.activeFilter,a.proxy(function(a,b){return this.activeFilter[b].length?b:void 0},this)),this.checkRows()},updateSearchTerm:function(a){this.activeSearchTerm=this.config.caseSensitiveSearch?a:a.toUpperCase(),this.checkRows()},setupEmptyTableMessage:function(){var b=a("<tr></tr>").addClass(this.config.emptyTableMessageClass);a("<td></td>").attr("colspan",this.numberOfColumns).html(this.config.emptyTableMessage).appendTo(b),b.hide().prependTo("tbody",this.$table)},checkIfTableIsEmpty:function(){var b=this.config.emptyTableMessageClass,c=a("tbody tr:visible",self.$table);return c.length?c.length===a("."+b).length?!0:void a("."+b).hide():(a("."+b).show(),!0)}},a.fn.filterable=function(d){return"undefined"==typeof d||"object"==typeof d?this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(a(this),d))}):void 0},a.extend(a.expr[":"],{containsNC:function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf((c[3]||"").toLowerCase())>=0}})}(jQuery,window,document);